<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>

</head>



<body>
    <div>
        <h2>Testing</h2>
    </div>
    <div id="image">
        <img src="http://localhost:8080/stream?topic=/camera/rgb/image_raw">
    </div>
</body>


<script src="http://static.robotwebtools.org/EventEmitter2/current/eventemitter2.js"></script>
<script src="http://static.robotwebtools.org/roslibjs/current/roslib.js"></script>

<script>
    var ros = new ROSLIB.Ros({
        url : 'ws://localhost:9090'
    });
    
    var GoalClient = new ROSLIB.ActionClient({
        ros : ros,
        serverName : '/Select_Goal_Server',
        actionName : 'visual_hmi/SelectGoalLocationAction'
    });

    var goal = new ROSLIB.Goal({
        actionClient : GoalClient,
        goalMessage : {
            x : 5,
            y : 10
        }
    })

    goal.on('feedback', function(feedback) {
        console.log('Feedback: ' + feedback.sequence);
    });

    goal.on('result', function(result) {
        console.log('Final Result: ' + result.sequence);
    });

    ros.on('connection', function() {
        console.log('Error connecting');
    });

    ros.on('error', function(error) {
        console.log('Error: ' + error);
    });

    ros.on('close', function(feedback) {
        console.log('Connection closed');
    });

    function SendGoal(x, y) {
        goal.send();
    }

    //goal.send();

    document.getElementById('image').onclick = function clickEvent(e) {
        // e = Mouse click event.
        var rect = e.target.getBoundingClientRect();
        var x = e.clientX - rect.left; //x position within the element.
        var y = e.clientY - rect.top;  //y position within the element.
        console.log("Left? : " + x + " ; Top? : " + y + ".");
        console.log("Width: " + (rect.right - rect.left) + "; Height: " + (rect.bottom - rect.top));
        SendGoal(x, y);
    }



    </script>

</html>